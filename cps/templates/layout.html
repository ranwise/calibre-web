{% from 'modal_dialogs.html' import restrict_modal, delete_book, filechooser_modal, delete_confirm_modal, change_confirm_modal %} {% import 'image.html' as image %}<!DOCTYPE html>

<html lang="{{ g.user.locale }}">
<head>
    <title>{{ instance }} | {{ title }}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" sizes="140x140" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">

    <link href="{{ url_for('static', filename='css/libs/bootstrap.min.css') }}" rel="stylesheet" media="screen">
    <link href="{{ url_for('static', filename='css/libs/bootstrap-icons.css') }}" rel="stylesheet">

    {% block header %}{% endblock %}

    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet" media="screen">
    <link href="{{ url_for('static', filename='css/upload.css') }}" rel="stylesheet" media="screen">

    {% if g.current_theme == 1 %}
        <link href="{{ url_for('static', filename='css/caliBlur.css') }}" rel="stylesheet" media="screen">
        <link href="{{ url_for('static', filename='css/caliBlur_override.css') }}" rel="stylesheet"
              media="screen">
    {% endif %}
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// --><!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script> <![endif]-->
</head>

<body class="{{ page }} {{ bodyClass }}" data-text="{{ _('Home') }}" data-textback="{{ _('Back') }}">
<!-- Static navbar -->
<nav class="navbar navbar-expand-lg bg-light">
    <div class="container-fluid">
        <a class="navbar-brand" href="{{ url_for('web.index') }}">{{ instance }}</a>
        <button class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent"
                aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                {% if g.user.is_authenticated or g.allow_anonymous %}
                    <li class="nav-item">
                        <form
                                class=""
                                role="search" action="{{ url_for('search.simple_search') }}"
                                method="GET">
                            <div class="input-group">
                                <label for="query"
                                       class="visually-hidden">{{ _('Search') }}</label>
                                <input
                                        type="text"
                                        class="form-control"
                                        id="query"
                                        name="query"
                                        placeholder="{{ _('Search Library') }}"
                                        value="{{ searchterm }}">

                                <button
                                        type="submit"
                                        id="query_submit"
                                        class="btn btn-outline-secondary"
                                >{{ _('Search') }}
                                </button>
                            </div>
                        </form>
                    </li>
                {% endif %}

                {% if g.user.is_authenticated or g.allow_anonymous %}
                    <li class="nav-item d-flex align-self-center px-3">
                        <a href="{{ url_for('search.advanced_search') }}"
                           id="advanced_search"
                           class="text-decoration-none">
                            <i class="bi bi-search"></i>
                            <span class="hidden-sm"> {{ _('Advanced Search') }}</span>
                        </a>
                    </li>
                {% endif %}
            </ul>

            <ul class="navbar-nav mr-auto mb-2 mb-lg-0">
                {% if g.user.is_authenticated or g.allow_anonymous %}
                    {% if g.user.role_upload() and g.allow_upload %}
                        <li class="nav-item mx-2">
                            <form id="form-upload" class="navbar-form"
                                  action="{{ url_for('edit-book.upload') }}"
                                  data-title="{{ _('Uploading...') }}"
                                  data-footer="{{ _('Close') }}"
                                  data-failed="{{ _('Error') }}"
                                  data-message="{{ _('Upload done, processing, please wait...') }}" method="post"
                                  enctype="multipart/form-data">
                                <input type="hidden" name="csrf_token"
                                       value="{{ csrf_token() }}">
                                <div class="form-group">
                                    <span class="btn btn-outline-secondary btn-file">{{ _('Upload') }}
                                    <input
                                            class=""
                                            id="btn-upload"
                                            name="btn-upload"
                                            type="file"
                                            accept="{% for format in accept %}.
                                                {% if format != '' %}{{ format }}{% else %}*{% endif %}{{ ',' if not loop.last }}{% endfor %}"
                                            multiple></span>
                                </div>
                            </form>
                        </li>
                    {% endif %}

                    {% if not g.user.is_anonymous and not simple %}
                        <li class="nav-item mx-2">
                            <a
                                    class="nav-link text-decoration-none"
                                    id="top_tasks"
                                    href="{{ url_for('tasks.get_tasks_status') }}">
                                <i class="bi bi-list-task"></i>
                                <span class="d-md-inline d-sm-none">{{ _('Tasks') }}</span>
                            </a>
                        </li>
                    {% endif %}

                    {% if g.user.role_admin() %}
                        <li class="nav-item mx-2">
                            <a class="nav-link text-decoration-none"
                               id="top_admin" data-text="{{ _('Settings') }}"
                               href="{{ url_for('admin.admin') }}">
                                <i class="bi bi-gear"></i>
                                <span class="d-md-inline d-sm-none">{{ _('Admin') }}</span>
                            </a>
                        </li>
                    {% endif %}
                    <li class="nav-item mx-2">
                        <a class="nav-link text-decoration-none" id="top_user"
                           data-text="{{ _('Account') }}" href="{{ url_for('web.profile') }}">
                            <i class="bi bi-person-fill"></i>
                            <span class="d-md-inline d-sm-none">{{ g.user.name }}</span>
                        </a>
                    </li>

                    {% if not g.user.is_anonymous %}
                        <li class="nav-item mx-2">
                            <a class="nav-link text-decoration-none"
                               id="logout"
                               href="{{ url_for('web.logout') }}">
                                <i class="bi bi-box-arrow-right"></i>
                                <span class="d-md-inline d-sm-none">{{ _('Logout') }}</span>
                            </a>
                        </li>
                    {% endif %}
                {% endif %}

                {% if g.allow_registration and not g.user.is_authenticated %}
                    <li class="nav-item mx-2">
                        <a class="nav-link text-decoration-none" id="login" href="{{ url_for('web.login') }}"><i
                                class="bi bi-box-arrow-in-right"></i> {{ _('Login') }}</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link text-decoration-none"
                           id="register" href="{{ url_for('web.register') }}">
                            <i class="bi bi-person-fill"></i> {{ _('Register') }}
                        </a>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>

{% for message in get_flashed_messages(with_categories=True) %}{% if message[0] == "error" %}
    <div class="row text-center">
        <div id="flash_danger" class="alert alert-danger">{{ message[1] }}</div>
    </div> {% endif %}{% if message[0] == "info" %}
    <div class="row text-center">
        <div id="flash_info" class="alert alert-info">{{ message[1] }}</div>
    </div> {% endif %}{% if message[0] == "warning" %}
    <div class="row text-center">
        <div id="flash_warning" class="alert alert-warning">{{ message[1] }}</div>
    </div> {% endif %}{% if message[0] == "success" %}
    <div class="row text-center">
        <div id="flash_success" class="alert alert-success">{{ message[1] }}</div>
    </div> {% endif %} {% endfor %} {% block flash %}{% endblock %} {% if g.current_theme == 1 %}
    <div id="loader" hidden="true">
        <h3>{{ _('Uploading...') }}</h3><span>{{ _("Please do not refresh the page") }}</span>.
    </div> {% endif %}
<div class="container-fluid">
    <div class="row">
        {% if g.user.is_authenticated or g.allow_anonymous %}
            <div class="col-sm-2">
                <nav class="navigation">
                    <ul class="list-unstyled" id="scnd-nav" intent in-standard-append="nav.navigation"
                        in-mobile-after="#main-nav"
                        in-mobile-class="nav navbar-nav">
                        <li class="nav-head hidden-xs">{{ _('Browse') }}</li> {% for element in sidebar %}
                        {% if g.user.check_visibility(element['visibility']) and element['public'] %}
                            <li id="nav_{{ element['id'] }}" {% if page == element['page'] %}class="active"{% endif %}>
                                <a
                                        href="{{ url_for(element['link'], data=element['page'], sort_param='stored') }}"><span
                                        class="bi {{ element['glyph'] }}"></span> {{ _(element['text']) }}</a>
                            </li>
                        {% endif %} {% endfor %} {% if g.user.is_authenticated or g.allow_anonymous %}
                        <li class="nav-head hidden-xs public-shelves">{{ _('Shelves') }}</li>
                        {% for shelf in g.shelves_access %}
                            <li class="align-middle">
                                <a class="" href="{{ url_for('shelf.show_shelf', shelf_id=shelf.id) }}"><i
                                    class="bi bi-list shelf"></i>{{ shelf.name|shortentitle(40) }}
                                {% if shelf.is_public == 1 %} {{ _('(Public)') }}{% endif %}</a></li> {% endfor %}
                        {% if not g.user.is_anonymous %}
                            <li id="nav_createshelf" class="create-shelf">
                                <a href="{{ url_for('shelf.create_shelf') }}">{{ _('Create a Shelf') }}</a>
                            </li>
                            <li id="nav_about"
                                {% if page == 'stat' %}class="active"{% endif %}><a
                                    class="btn-link btn-outline"
                                    href="{{ url_for('about.stats') }}">
                                <i class="bi bi-info-circle-fill"></i> {{ _('About') }}</a></li>
                        {% endif %} {% endif %}</ul>
                </nav>
            </div> {% endif %}
        <div class="col-10">
            {% block body %}{% endblock %}
            {% if pagination and (pagination.has_next or pagination.has_prev) %}
                <div class="pagination">{% if pagination.has_prev %}
                    <li class="page-item page-previous"><a class="page-link" aria-label="next page"
                                                           href="{{ (pagination.page - 1)|url_for_other_page }}">&laquo; {{ _('Previous') }}</a>
                    </li> {% endif %}{% for page in pagination.iter_pages() %}{% if page %}
                    {% if page != pagination.page %}
                        <li class="page-item"><a class="page-link" aria-label="to page {{ page }}"
                                                 href="{{ (page)|url_for_other_page }}">{{ page }}</a></li>{% else %}
                        <li class="page-item active"><a class="page-link" aria-label="to page {{ page }}"
                                                        href="{{ (page)|url_for_other_page }}">{{ page }}</a>
                        </li> {% endif %}{% else %}
                    <li class="page-item page-last-separator disabled"><a class="page-link" aria-label="">â€¦</a></li>
                {% endif %} {% endfor %}{% if pagination.has_next %}
                    <li class="page-item page-next"><a class="page-link next" aria-label="next page"
                                                       href="{{ (pagination.page + 1)|url_for_other_page }}">{{ _('Next') }}&raquo;</a>
                    </li> {% endif %}
                </div> {% endif %}
        </div>
    </div>
</div>
<div class="modal fade" id="bookDetailsModal" tabindex="-1" role="dialog" aria-labelledby="bookDetailsModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="bookDetailsModalLabel">{{ _('Book Details') }}</h4>
                <button type="button" class="close btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">...</div>
            <div class="modal-footer">
                <button type="button" id="details_close" class="btn btn-outline-danger"
                        data-bs-dismiss="modal">{{ _('Close') }}</button>
            </div>
        </div>
    </div>
</div>
{% block modal %}{% endblock %} <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="{{ url_for('static', filename='js/libs/jquery.min.js') }}"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="{{ url_for('static', filename='js/libs/bootstrap.bundle.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/libs/underscore-umd-min.js') }}"></script>
<script src="{{ url_for('static', filename='js/libs/intention.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/libs/context.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/libs/plugins.js') }}"></script>
<script src="{{ url_for('static', filename='js/libs/jquery.form.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/uploadprogress.js') }}"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script> {% if g.current_theme == 1 %}
    <script src="{{ url_for('static', filename='js/libs/jquery.visible.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/libs/compromise.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/libs/readmore.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/caliBlur.js') }}"></script> {% endif %} {% block js %}{% endblock %}
</body>
</html>
